---
title: "Single Cell Data Analysis (Bioinformatics Landscape)"
subtitle: ""
author: "Sung"
output:
  rmarkdown::html_vignette:
    toc: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=F, message=F, warning=F)
options(rmarkdown.html_vignette.check_title = FALSE)
```

<br><br>

---

### Overview 

**Comprehensive Multi-Stage**

- Niyom et al., Frontiers in Cell and Developmental Biology, 2018
- Chon et al., Frontiers in Genetics, 2019
- Laffi et al., Nature Protocols, 2016

**Cell/Nucleus Preparation**

- Bakken et al., PLOS One, 2020
- Danilenko, Genome Biology, 2019

**sc-RNAseq Platforms**

- Da-Ge et al., Nature Biotechnology, 2020
- Zhegnzhun et al., Molecular Cell, 2017

**Multi-Modal Techniques**

- Stuart & Satija, Nature Reviews Genetics, 2019
- Ziyu, Freissl & Ren, Nature Methods, 2020

**Data Analysis & Clustering**

- Lucetten & Theis, Molecular Systems Biology, 2019
- Kiselev, Andrews & Hemberg, Nature Reviews Genetics, 2013
- Hasumas et al., Nature Reviews Genetics, 2023

**Differential Expression**

- Semenov & Robinson, Nature Methods, 2018
- Wang et al., BMC Bioinformatics, 2019
- Nypenn et al., Nature Communications, 2021

**Trajectory Inference**

- Saelens, Nature Biotechnology, 2019
- Doorninkat et al., Current Opinions in Systems Biology, 2021

[Website]
https://www.sc-best-practices.org/

---

### Various aspects of data handling and analysis

**Technical variation**

- Batch effects
- Cell capture efficiency
- Amplification bias
- Dropout

**Biological variation**

- Stochastic gene expression
- Environmental shifts
- Cell cycle

**Data Integration**

- Normalized Data
- Corrected Data

**Cell/Nucleus Preparation**

- Cell Isolation
- Enrichment
- Characterization
- Cell Integrity Assessment

**Gene Expression Profiling**

- Gene Level
- Transcript Level
- Regulatory Network
- Gene Set (Pathway) Analysis

**Computational Analysis**

- Many multicomponent
- Separation of clusters and outliers
- Technical vs. biological variation
- Downstream
- Canonical correlation analysis (CCA)
- MAST

**Sample Batch Correction Approaches**

- Cell Hashing
- Demuxlet
- MAST

---

### Different aspects of cellular analysis

**Transcriptome**

**Chromatin Accessibility**

**Surface Protein Expression**

**Adaptive Immune Receptor Repertoires**

<br><br>

**Integrated Data**

- Spatial resolution: High
- Quantity: Large
- Depth: Extensive
- Cell Type Coverage: Comprehensive

**Adaptive Immune Receptor Repertoire**

- Diversity
- Clonality
- Neoantigens

**Surface Protein**

- Receptors
- Ligands
- Co-stimulatory Molecules

**Therapeutic Accessibility**

- RNA
- AAV

---

### Transcriptome: Quality Filtering and Noise Correction

**Key Words**

- **Barcodes** – Unique known nucleic acid sequences of fixed length used to label individual cells to enable tracking through space and time.
- **Confounding Sources of Variation** – Technical artefacts that arise from library preparation and sequencing, and biological confounders such as cell cycle status, which cause systematic bias and may distort biological findings.
- **Ambient RNA** – mRNA counts that originate from other lysed cells in the input solution and do not belong to the cell captured in the droplet itself.

**Information and Packages**

- **Unique Molecular Identifiers (UMI)** – Improved alternative to barcodes with less amplification bias.
- **Plate-based vs Droplet-based Protocols**
- **Genome Annotation Selection**
- **Base Assignment** – Each droplet contains RNA from a single intact cell.
- **Manual vs Automatic** (mean absolute deviations)
- **Quality Control Filtering** should be performed at the sample level.
- **Always evaluate Quality Covariates together**
- **Doublet detection and artificial duplicates** – multiple methods.

**Tools for QC**

- **Ambient QC**: SoupX, CellBender
- **Doublet Finder**: DoubletFinder, scDblFinder

---

### Transcriptome: Normalization and Dimensionality Reduction

**Key Words**

- **K nearest-neighbors (KNN) graph** – A computational data structure in which cells are represented as nodes in a graph. Based on distance metrics such as the Euclidean distance on a principal-component reduced expression, cells are connected to their K most similar cells.
- **Scaling** – Normalization of gene expression levels that scales gene counts to zero mean and unit variance
- **Batch effects** – Confounding effects that result from technical differences in data generation across different batches, such as samples obtained through different experimental set-ups or from different laboratories

**Information and Packages**

- **Heterogeneity in Cell Size, Sampling, Batch, Sample-Sample** – Affects depth of coverage
- **Data Scaling Factor Assumptions** – Heterogeneity key
- **Use Optimization Depends on Downstream Application**
- **Shifted Log (e.g., Normalized Data) vs Pearson Residuals** (scTransform)
- **Biological Confounds** – Cell Cycle if declared
- **Highly-Variable Features and PCA** – Visualization/Summarization
- **HVG (Highly Variable Genes)** – Highly sensitive to normalization strategy

**Tools**

- **Normalization**: Scan, Seurat, Scanpy
- **Cell Cycle**: Seurat/Scanpy -> [TryCycle](https://bioconductor.org/packages/release/bioc/vignettes/tricycle/inst/doc/tricycle.html)

---

### Transcriptome: Normalization and Dimensionality Reduction (continued)

**Key Features and Benchmarks**

- **Consistency**: We downloaded ten 10x datasets from the Gene Expression Omnibus (GEO) database. As there was no formal ground truth, we measured the consistency of the results (a necessary, although not sufficient, condition for their goodness) by splitting the genes of each dataset into two disjoint subsets.

- **Simulation**: We used four different previously published simulation frameworks and one adapted by us to generate a diverse collection of datasets for which we had full access to the true k-NN graph.

- **Downsampling**: We used five deeply sequenced datasets based on mcSCRB and Smart-seq3, which we downsampled to sequencing depths typical for the 10x technology. We postulated that a proxy for ground truth could be constructed from the k-NN graph inferred from the deeply sequenced data intersected across all transformations which we call relatable nearest neighbor. To our knowledge, this work presents the first instance of such a comprehensive approach.

---

### Transcriptome: Batch Correction and Data Integration

**Key Words**

- **K nearest-neighbor (KNN) graph** – A computational data structure in which cells are represented as nodes in a graph. Based on distance metrics such as the Euclidean distance on a principal-component reduced expression, cells are connected to their K most similar cells.
- **Scaling** – Normalization of gene expression levels that scales gene counts to zero mean and unit variance.
- **Batch effects** – Confounding effects that result from technical differences in data generation across different batches, such as samples obtained through different experimental set-ups or from different laboratories.

**Information and Packages**

- **Heterogeneity by Cell Size, Sampling, Batch, Sample-Sample Depth of Coverage**
- **Shifted Log (e.g., NormalizedData) vs Pearson Residuals (scTransform)**
- **Data Scaling Factor Assumptions**
- **Use Optimization Depends on Downstream Application**
- **Preliminary Visualization of Batch Effects Useful**
- **Biological Confounds** – Cell Cycle if declared
- **Highly-Variable Features and PCA** – Visualization/Summarization

**Assessment Tools**

- **scIB**
- **Batch Effect/Data Integration Tools**: CCA/Harmony, scVI, kBET, scGen, Scanorama (tSNE-embedding), LIGER, ZINB-WaVE, (scIB)

**Cell Cycle**

- **Seurat/Scanpy -> TryCycle**

---

### Transcriptome: Cross Species Data Integration and Benchmarking

**Information and Packages**

- **Heterogeneity in Cell Size, Sampling, Batch, Sample-Sample Depth of Coverage**
- **28 strategies across 4 gene homology mapping and 9 batch integration approaches**
- **Principal component regression, Average Silhouette Width, graph connectivity, and others contributed into overall species-mixing score**

**Assessment: scIB**

- **Spender Batch Effect Integration Evaluation**: BENGAL, SAMap
- **Batch Effect/Data Integration**: CCA/Harmony, LIGER, Seurat, scANVI, Scanorama (tSNE-embedding), scVI
- **Cell Cycle**: Seurat/Scanpy -> TryCycle

**BENGAL (BENchmarking strategies for cross-species integration of single-cell RNA sequencing data)**


Evaluates integration effectiveness across species using varied techniques and metrics to provide a comprehensive framework for assessing cross-species data integration performance.


### Transcriptome: Cross Species Data Integration and Benchmarking

**Processes Involved:**

1. **Preprocessing**
   - 1x species data QC
   - Adjusted histograms
   - Cohorts (e.g., B6MT mice)
   - Ontology preparation

2. **Adjust and fine-tune evolutionary annotation (optional)**

   - Adjust gene expression and evolution scripts
   - Cell ontology
   - Gene expression verification and adjustment

3. **Build concentrated signal**

   - Pathway topology centrality
   - Cost-structured gene manipulation
   - Cell lineage hierarchy
   - Evolutionary conservation of signal

4. **Data integration**

   - Workflow pipeline integration
   - (Diagram showing integration flow using tools like LIGER, Seurat, Harmony, etc.)

**Assessment of Species Analogy: Strategy Overview and Integration Validity**

   - Assessment visual flow
   - Benchmarks deploying manifold expansion
   - Astray’s plot of nets
   - Cross-species data consistency
   - Geographical information flow
   - Integrated data check for 18+ species

**Tools and Methods:**

   - Multifaceted cross-species integration tools: LIGER, Seurat, Harmony, etc.
   - Specificity tests: Tissue conservation tests, cross-species functional tests
   - Outcome and validation: Adjusted grid relay, tissue community assessment, cross-species integrated test
   
   
---

### Transcriptome: Cell Clusters and Cell Identities

**Key Words**

- **Reference Mapping** – The process of leveraging and transferring information from a reference data set to a query
- **Cell Fate** – A cell’s final cell type that is established by corresponding, specific transcriptional programs
- **Trajectory Inference** – Also known as pseudotime analysis. Ordering of cells along a trajectory based on gene expression similarity

**Information and Packages**

- Louvain vs Leiden
  - Always check multiple resolutions for robustness
- Three Step Approach to Annotation
  - Classifier + Reference Mapping (Query to Reference)
  - Manual Annotation + Unbiased Clustering
  - Expert Annotation
- Marker Genes - Wilcoxon Rank Sum Test
- Underlying Topology most important for Trajectory Inference

**Classifiers:** CellTypist, Classify   
**scGPT**. 
**Reference Based:** scArches, Symphony, Azimuth   
**Simple topology:** Slingshot, Monocle   
**Complex Topology:** [PAGA] (https://scanpy-tutorials.readthedocs.io/en/latest/paga-paul15.html), RaceID/StemID   

---

### Transcriptome: Cell Clusters and Cell Identities (Continued)

**Key Words**

- **RNA Velocity** – Ratios of spliced mRNA, unspliced mRNA and mRNA degradation. Positive ratios (velocities) indicate recent increases in unspliced transcripts followed by upregulation of spliced transcripts. Negative velocities indicate downregulation. Examining velocities across genes can provide insight into future states of individual cells.
- **Phase Portrait** – For any given gene, the phase portrait visualizes splicing kinetics as a parametric curve (with time as a parameter).
- **Lineage Tracing** – Tracking physiological or pathological changes by exogenous or endogenous cell markers such as DNA mutations.

**Information and Packages**

- **Fixation Data** – Add on to incorporate into trajectory inference.
- **Model Splicing Kinetics** – With proportions of intron and exon splicing reads.
- **Be Wary of Transcriptional Bursts** – Note caution in interpreting data.
- **Always Investigate Phase Portrait** – To verify data consistency.

**Tools**

- **RNA Velocity**: Velocyto, scVelo
- **Incorporation with TT (Time Travel)** – Enhancing cell trajectory analysis.

---

### Transcriptome: Differential Expression with Batch Correction and Covariates

**Key Words**

- **Differential Gene Expression** – The inference of statistically significant differences in expression between groups such as healthy and diseased.
- **Pseudobulks** – Aggregated cells within a biological replicate whereby the data from every single cell is combined via sum or mean of counts into a single pseudo-sample to resemble a bulk RNA experiment.
- **Pseudoreplication** – Also known as subsampling. Pseudoreplication occurs when replicates are not statistically independent, but are treated as if they were, such as cell samples from a single individual.

**Information and Packages**

- **MAST and Wilcoxon RS** perform well for sparse, cell-level sc Data.
- Can be variable and poor with highly expressed genes.
- **High TPR vs High Precision**
- Whenever available, bulk methods still perform favorably when combined with pseudobulking (at sufficient depth).

**Tools**

- **Single Cell**: MAST (with random effect), Wilcoxon RS
- **Pseudobulk DE analysis**: DESeq2, limma

---

### Transcriptome: Differential Expression and Mechanistic Insights

**Key Words**

- **Gene Set Enrichment** – Grouping genes with shared characteristics together and testing for over-representation.
- **Compositional Data** – Comprises multi-dimensional data points (for example, cell-type composition) in which each component (or part) carries only proportional or relative abundance information about some whole.
- **Cell-Cell Communication** – Interactions of cells through secreted ligands and plasma membrane receptors, secreted enzymes, extracellular matrix proteins, or cell-cell adhesion proteins and gap junctions.

**Information and Packages**

- **Summarization of molecular insights into interpretable terms.**
- **Databases**: MSigDB, Enrichr, KEGG, Reactome
  - Be wary of database coverage biases related to data.
- **Weighted gene sets**
  - Can be applied after DEG (Differential Expression Gene) analysis.
- **Compositional Data vs Internal Normalization**
- **Perturbation Modeling** (Experimental and In-Silico)
  - Cell-Cell Communication – Ligand/Receptor, Beware biases
- **Perturbation Models** (Experimental): MUSC, Microscope, Augur, MELD
- **Perturbation Modeling** (In Silico): scGen, CVA, CellRox
- **Cell-Cell Communication**: CellPhoneDB, CellChat, [SingleCellSignalR](https://bioconductor.org/packages/release/bioc/vignettes/SingleCellSignalR/inst/doc/UsersGuide.html), [LIANA](https://saezlab.github.io/liana/)
- **Weighted Gene Sets**: [DoRothEA](https://dorothea.opentargets.io/#/), [GScluster](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6507172/)

---

<br><br><br><br>

<!-- <br> Update: "`r format(Sys.Date())`" -->